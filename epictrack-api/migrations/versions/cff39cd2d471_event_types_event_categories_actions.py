"""event_types, event_categories, actions

Revision ID: cff39cd2d471
Revises: eed10a65e3c3
Create Date: 2023-10-24 17:59:01.979152

"""
from alembic import op
import sqlalchemy as sa


# revision identifiers, used by Alembic.
revision = 'cff39cd2d471'
down_revision = 'eed10a65e3c3'
branch_labels = None
depends_on = None

actions = [
    "SetEventDate",
    "AddEvent",
    "SetPhasesStatus",
    "SetEventsStatus",
    "SetWorkState",
    "SetProjectStatus",
    "LockWorkStartDate",
    "SetWorkDecisionMaker",
    "AddPhase",
    "SetPhaseLegislation",
    "CreateWork"
]

def upgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    with op.batch_alter_table('work_phases', schema=None) as batch_op:
        batch_op.add_column(sa.Column('legislated', sa.Boolean(), nullable=True))

    with op.batch_alter_table('work_phases_history', schema=None) as batch_op:
        batch_op.add_column(sa.Column('legislated', sa.Boolean(), autoincrement=False, nullable=True))
    op.execute("TRUNCATE actions RESTART IDENTITY CASCADE")
    for action in actions:
        op.execute(f"INSERT INTO actions(name) VALUES('{action}')")
    op.execute("INSERT INTO event_categories(name, sort_order)VALUES('Special Extension',8)")
    op.execute("UPDATE event_types set name='PCP Time Limit Extension' where id = 25")
    op.execute("alter sequence  event_types_id_seq restart with 37")
    op.execute("alter sequence event_categories_id_seq restart with 8")
    op.execute("INSERT INTO event_types(name, event_category_id, sort_order) VALUES ('Date Capture', 1, 10)")
    op.execute("INSERT INTO event_types(name, event_category_id, sort_order) VALUES ('Time Limit Resumption', 3, 2)")

    # ### end Alembic commands ###


def downgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    with op.batch_alter_table('work_phases_history', schema=None) as batch_op:
        batch_op.drop_column('legislated')

    with op.batch_alter_table('work_phases', schema=None) as batch_op:
        batch_op.drop_column('legislated')

    # ### end Alembic commands ###
